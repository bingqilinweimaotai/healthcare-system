import{d as b,u as h,c as x,a as d,b as o,w as t,r as a,e as C,o as I,f as z,g as c,h as f,i as B,p as E,E as _,_ as L}from"./index-DGdM1tdo.js";const N={class:"login-page"},R={class:"card"},q={class:"footer"},A=b({__name:"Login",setup(K){const g=C(),w=h(),i=f(),r=f(!1),s=B({username:"",password:""}),v={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]};async function m(){var l;await((l=i.value)==null?void 0:l.validate().catch(()=>{})),r.value=!0;try{const e=await E("/auth/login",s);w.setLogin({token:e.token,userId:e.userId,username:e.username,role:e.role,nickname:e.nickname}),_.success("登录成功"),g.replace("/")}catch(e){_.error(typeof e=="string"?e:(e==null?void 0:e.message)??"登录失败")}finally{r.value=!1}}return(l,e)=>{const p=a("el-input"),n=a("el-form-item"),y=a("el-button"),k=a("el-form"),V=a("router-link");return I(),x("div",N,[d("div",R,[e[4]||(e[4]=d("h1",null,"AI 智能问诊平台",-1)),o(k,{ref_key:"formRef",ref:i,model:s,rules:v,"label-width":"0",class:"form"},{default:t(()=>[o(n,{prop:"username"},{default:t(()=>[o(p,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=u=>s.username=u),placeholder:"用户名",size:"large"},null,8,["modelValue"])]),_:1}),o(n,{prop:"password"},{default:t(()=>[o(p,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=u=>s.password=u),type:"password",placeholder:"密码",size:"large","show-password":"",onKeyup:z(m,["enter"])},null,8,["modelValue"])]),_:1}),o(n,null,{default:t(()=>[o(y,{type:"primary",size:"large",loading:r.value,style:{width:"100%"},onClick:m},{default:t(()=>[...e[2]||(e[2]=[c("登录",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),d("div",q,[o(V,{to:"/register"},{default:t(()=>[...e[3]||(e[3]=[c("注册账号",-1)])]),_:1})])])])}}}),M=L(A,[["__scopeId","data-v-7bf8f68a"]]);export{M as default};
