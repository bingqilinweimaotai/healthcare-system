import{d as C,q as x,c as n,b as _,w as p,r as v,o,a as u,F as b,s as k,f as I,v as V,g as A,h as d,p as E,x as f,E as N,y as S,t as g,_ as B}from"./index-BHCkwbks.js";const K={class:"ai-consult"},T={class:"chat"},z={key:0,class:"empty"},D={key:1,class:"messages"},F={class:"bubble"},L={class:"time"},M={class:"input-row"},U=C({__name:"AiConsult",setup($){const l=d(null),i=d([]),r=d(""),c=d(!1);x(l,async s=>{if(!s){i.value=[];return}const e=await f(`/ai/sessions/${s}/messages`);i.value=e??[]});function y(s){return s?new Date(s).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):""}async function m(){var e;const s=(e=r.value)==null?void 0:e.trim();if(!(!s||c.value)){c.value=!0;try{const t=await E("/ai/consult",{sessionId:l.value||void 0,content:s});r.value="",l.value=t.sessionId,i.value=await f(`/ai/sessions/${t.sessionId}/messages`)}catch(t){N.error((t==null?void 0:t.message)??"发送失败")}finally{c.value=!1}}}return(s,e)=>{const t=v("el-input"),h=v("el-button"),w=v("el-card");return o(),n("div",K,[_(w,null,{default:p(()=>[u("div",T,[l.value?(o(),n("div",D,[(o(!0),n(b,null,k(i.value,a=>(o(),n("div",{key:a.id,class:S(["msg",a.sender==="USER"?"user":"ai"])},[u("div",F,g(a.content),1),u("div",L,g(y(a.createdAt)),1)],2))),128))])):(o(),n("div",z,"发起新会话：在下方输入症状或问题，发送给 AI 获取建议。"))]),u("div",M,[_(t,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),type:"textarea",rows:2,placeholder:"描述症状或问题...",onKeydown:I(V(m,["ctrl"]),["enter"])},null,8,["modelValue","onKeydown"]),_(h,{type:"primary",loading:c.value,onClick:m},{default:p(()=>[...e[1]||(e[1]=[A("发送",-1)])]),_:1},8,["loading"])])]),_:1})])}}}),R=B(U,[["__scopeId","data-v-60e2845e"]]);export{R as default};
